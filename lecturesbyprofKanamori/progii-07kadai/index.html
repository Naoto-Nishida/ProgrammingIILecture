<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><title>第 7 回レポート課題 - 2018 年度プログラミング実習 II -</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8"/><link rel="canonical" href="http://archive.today/1052j"/></head><body style="margin:0;background-color:white;width:1024px"><div class="html1" style="width: 1024px;text-align: left;overflow-x: auto;overflow-y: auto; background-color: rgba(0, 0, 0, 0);position: relative;min-height: 6607px;; z-index: 0"><div class="html" style="text-align:left;overflow-x:visible;overflow-y:visible;">











<div class="body" style="vertical-align:bottom;min-height:6578px;color:rgb(0, 0, 0);text-align:left;counter-reset:chapter 0;overflow-x:visible;overflow-y:visible;margin: 8px; "><h1 style="text-align:left;background-color:rgb(187, 187, 238);counter-increment:chapter 1;counter-reset:section 0;border-width:1px;border-style:solid;padding:5px 3px 3px 0.5em;border-color:rgb(204, 204, 255) rgb(102, 102, 153) rgb(102, 102, 153) rgb(204, 204, 255)"><span style="counter-reset:chapter 7;">第, counter(7.1175e-38), '回 '</span>レポート課題</h1>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">下記の「課題 7-1」〜「課題 7-2」を解き、課題レポート提出法 (実習のトップページに記載) に従って提出しなさい。</div>

<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;"><font color="red" style="text-align:left;">それぞれの課題で Makefile を別々のファイルとせよ。例えば課題ごとに Makefile1, Makefile2 などという名前にした場合、これらを使って make コマンドを実行するには make -f Makefile1 のように -f オプションを付けてファイル名を指定する。</font></div>
<h3 style="text-align:left;background-color: rgb(221, 187, 187); border-width: 1px; border-style: solid; padding: 5px 3px 3px 0.5em; border-color: rgb(255, 204, 204) rgb(153, 102, 102) rgb(153, 102, 102) rgb(255, 204, 204); "><span style="display:inline;counter-increment:section 1;counter-reset:chapter 7">課題 ', counter(2.81133e+195), '-', counter(-2.46498e+75), ' </span></h3>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
<a href="http://archive.today/o/1052j/kanamori.cs.tsukuba.ac.jp/lecture/2018/prog2/pages/r5.html" style="text-align:left;">第 5 回のレポート課題</a>
で作成した画像の読み書きのプログラムには、実は、次のような問題があった。
</div><ol style="text-align:left;">
<li style="text-align:left;line-height:130%;"><b style="text-align:left;"><font color="red" style="text-align:left;">画像の横幅、縦幅、データを格納する配列が別々の変数になっていて、管理が面倒</font></b></li>
<li style="text-align:left;line-height:130%;"><b style="text-align:left;"><font color="red" style="text-align:left;">画像データを格納する配列のサイズが固定で、メモリが無駄 or メモリ不足になりうる</font></b></li>
<li style="text-align:left;line-height:130%;"><b style="text-align:left;"><font color="red" style="text-align:left;">1 ピクセルごとのバイト数がグレースケール画像 (1 バイト) と RGB 画像 (3 バイト) で異なるのに、区別できない</font></b></li>
</ol>
上記の問題を、画像データを保持する構造体を用いることで解消しよう。 <font color="red" style="text-align:left;">※第 5 回 の模範解答を参考にしてよい。</font>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;"></div>
<ol style="text-align:left;list-style-type:lower-alpha;">
<li style="text-align:left;line-height:130%;">
画像データを保持する構造体 ImageData を宣言せよ。ImageData のメンバ変数には次のものを含めること。 <ul style="text-align:left;">
<li style="text-align:left;line-height:130%;">画像の横幅 width および縦幅 height</li>
<li style="text-align:left;line-height:130%;">1 ピクセルあたりのチャンネル数 (バイト数) channels</li>
<li style="text-align:left;line-height:130%;">画像のピクセルデータを保持するためのポインタ data</li>
</ul>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">構造体 ImageData を扱うために、以下の関数を作成せよ。</div>
<ul style="text-align:left;">
<li style="text-align:left;line-height:130%;">
ImageData のメンバ data のためのメモリを確保し各種メンバ変数を設定する関数 AllocateImage <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">int AllocateImage(ImageData *img, int _w, int _h, int _channels);
</pre>
_w, _h は画像の横幅、縦幅、_channels は 1 ピクセルあたりのチャンネル数を示す。返り値は、メモリの確保に成功すれば 1、失敗したら 0。この関数ではさらに、構造体のメンバ変数に、与えられた画像の横幅、縦幅、チャンネル数を代入する。 </li><br style="text-align:left;"/>
<li style="text-align:left;line-height:130%;">
ImageData のメンバ data のためのメモリを解放する関数 ReleaseImage <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">void ReleaseImage(ImageData *img);
</pre>
</li>
<li style="text-align:left;line-height:130%;">
ImageData (のメンバ data) をコピーする関数 CopyImage <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">void CopyImage(ImageData *imgIn, ImageData *imgOut);
</pre>
imgIn がコピー元の画像データ、imgOut がコピー先の画像データ。関数の内部で imgOut のメモリの確保も行う。第 7 回の練習問題でやった「浅いコピー」にならないよう注意。 </li><br style="text-align:left;"/>
<li style="text-align:left;line-height:130%;">
PGM 形式のグレースケール画像もしくは PPM 形式のカラー画像をファイルから読み込む関数 LoadImage <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">int LoadImage(const char *filename, ImageData *img);
</pre>
filename は読み込むファイル名。この関数の中でファイルをオープンし、アスキー形式とバイナリ形式の両方をサポートすること。返り値は、読み込みに成功すれば 1、失敗したら 0。 </li><br style="text-align:left;"/>
<li style="text-align:left;line-height:130%;">
PGM 形式のグレースケール画像もしくは PPM 形式のカラー画像をファイルに書き込む関数 SaveImage <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">int SaveImage(const char *filename, ImageData *img);
</pre>
filename は書き込むファイル名。この関数の中でファイルをオープンすること。返り値は、書き込みに成功すれば 1、失敗したら 0。書き込みはバイナリ形式。 </li><br style="text-align:left;"/>
</ul>
これらの関数が正しく動作していることを確認できるプログラムを作成せよ。ただし、printf 文で内容を出力するような方法ではなく、画像を入力して計算結果の画像を出力するような方法を取ること。また、make コマンドを用いて分割コンパイルできるようにすること。 </li><br style="text-align:left;"/>
<li style="text-align:left;line-height:130%;">
上記で作成した画像ライブラリを用いて、画像にぼかしをかけるのに用いられる、ガウスフィルタを実装してみよう。次の関数宣言を用いよ。 <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">void GaussianFilter(ImageData *imgIn, ImageData *imgOut);
</pre>
imgIn が入力の画像データ、imgOut が出力の画像データである。ただし、 <ul style="text-align:left;">
<li style="text-align:left;line-height:130%;">imgOut のメモリは確保されているものとする (GaussianFilter 関数内ではメモリの確保は行わない)</li>
<li style="text-align:left;line-height:130%;">imgIn と imgOut の画像の横幅、縦幅、チャンネル数は一致しているものとする</li>
<li style="text-align:left;line-height:130%;">グレースケール画像でもカラー画像でも動作するようにする</li>
<li style="text-align:left;line-height:130%;">imgIn と imgOut には同じ画像データへのポインタ (アドレス) を指定することはできない</li>
</ul><br style="text-align:left;"/>
ここで、ガウスフィルタの実装方法について説明する。入力画像 imgIn および出力画像 imgOut の横幅が w、縦幅が h だとする。出力画像 imgOut の座標 (xi, yi) のピクセルの色を計算するために、入力画像 imgIn の座標 (xi, yi) の近傍のピクセルの色を取ってきて、その加重平均を取る。ここでは「近傍」の大きさを 3x3 とする。つまり、中心が座標 (xi, yi) のピクセルで、その周囲の上下左右斜めの 8 ピクセル、合計 9 ピクセルを対象とする。加重平均の重みは、合計が 1 になるようにする。ここでは次の値を用いる (3x3 の各ピクセルの重みに対応)。 <div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
</div><table style="text-align:left;border-width: 1px; border-style: outset; border-color: #999; ">
<tbody style="text-align:left;"><tr style="text-align:left;"><td style="color:rgb(0, 0, 0);text-align:left;border-width: 1px; border-style: inset; border-color: rgb(128, 128, 128); ">1.0/16.0</td><td style="color:rgb(0, 0, 0);text-align:left;border-width: 1px; border-style: inset; border-color: rgb(128, 128, 128); ">2.0/16.0</td><td style="color:rgb(0, 0, 0);text-align:left;border-width: 1px; border-style: inset; border-color: rgb(128, 128, 128); ">1.0/16.0</td></tr>
<tr style="text-align:left;"><td style="color:rgb(0, 0, 0);text-align:left;border-width: 1px; border-style: inset; border-color: rgb(128, 128, 128); ">2.0/16.0</td><td style="color:rgb(0, 0, 0);text-align:left;border-width: 1px; border-style: inset; border-color: rgb(128, 128, 128); ">4.0/16.0</td><td style="color:rgb(0, 0, 0);text-align:left;border-width: 1px; border-style: inset; border-color: rgb(128, 128, 128); ">2.0/16.0</td></tr>
<tr style="text-align:left;"><td style="color:rgb(0, 0, 0);text-align:left;border-width: 1px; border-style: inset; border-color: rgb(128, 128, 128); ">1.0/16.0</td><td style="color:rgb(0, 0, 0);text-align:left;border-width: 1px; border-style: inset; border-color: rgb(128, 128, 128); ">2.0/16.0</td><td style="color:rgb(0, 0, 0);text-align:left;border-width: 1px; border-style: inset; border-color: rgb(128, 128, 128); ">1.0/16.0</td></tr>
</tbody></table>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;"></div>
なお、座標 (xi,yi) が画像の端のときは注意が必要である。つまり例えば、xi == 0 のときは、3x3 近傍を探そうとすると xi == -1 のピクセルにアクセスしようとする。 また、xi == w-1 のときは、xi == w にアクセスしようとする。これらの座標は不正であり (x 座標は 0 から w-1 まで、y 座標は 0 から h-1 までが OK) 、セグメンテーション違反の原因になる。 こういった場合は強制的に、x 座標が -1 になるときは 0 に、w になるときは w-1 に切り詰めるようにする。yi についても同様である。 <div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
最終的に、入力画像のファイル名と、ガウスフィルタを適用する回数をコマンドラインから受け取り、指定された回数だけ入力画像にガウスフィルタを適用して、計算結果の画像を出力するプログラムを作成せよ。 make コマンドを用いて分割コンパイルできるようにすること。 </div>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
<b style="text-align:left;"><font color="red" style="text-align:left;">
※問題 a と同じソースファイル/ヘッダファイルを用いる場合は、レポートの問題 a の解答にそれらを載せておけば問題 b の解答には載せなくてよい。 </font></b>
</div>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;"><strong style="text-align:left;">[適用例]</strong></div>
<table style="text-align:left;border-width: 0px; border-style: outset; border-color: #999; ">
<tbody style="text-align:left;"><tr style="text-align:left;"><td style="color:rgb(0, 0, 0);text-align:left;"><img src="111eb1737085f4fbfcd4601d6e555f8f8ffc43bb.jpg" style="width:128px;text-align:left;"/></td><td style="color:rgb(0, 0, 0);text-align:left;"><img src="999e714adff7c9462fcc9f2e4f9eae04ab30e71f.jpg" style="width:128px;text-align:left;"/></td><td style="color:rgb(0, 0, 0);text-align:left;"><img src="21183a6e26f1ab6674dfb8e46ae064af706f2da6.jpg" style="width:128px;text-align:left;"/></td><td style="color:rgb(0, 0, 0);text-align:left;"><img src="826a5e19ec701743c55c9843aaf858bd62a3e806.jpg" style="width:128px;text-align:left;"/></td><td style="color:rgb(0, 0, 0);text-align:left;"><img src="327426be1be9118e0d3b70a2f60e42468457372b.jpg" style="width:128px;text-align:left;"/></td></tr><tr style="text-align:left;">
</tr><tr style="text-align:left;"><td style="color:rgb(0, 0, 0);text-align:left;"><img src="637c93cafe1246d08dd40fa7ebbd18c31a811290.jpg" style="width:128px;text-align:left;"/></td><td style="color:rgb(0, 0, 0);text-align:left;"><img src="ec8ecc066e3250c06848a3f7c15397143e1f688f.jpg" style="width:128px;text-align:left;"/></td><td style="color:rgb(0, 0, 0);text-align:left;"><img src="c1d4e54b4c2c2d04929e8ece72af62aed364c4b0.jpg" style="width:128px;text-align:left;"/></td><td style="color:rgb(0, 0, 0);text-align:left;"><img src="e04d76b0209ae41edc54558ef329684a80747259.jpg" style="width:128px;text-align:left;"/></td><td style="color:rgb(0, 0, 0);text-align:left;"><img src="24b77505cd5dc51db4693c57eed526eb998b30ba.jpg" style="width:128px;text-align:left;"/></td></tr><tr style="text-align:left;">
</tr><tr style="text-align:left;"><td style="color:rgb(0, 0, 0);text-align:left;">1 回適用</td><td style="color:rgb(0, 0, 0);text-align:left;">5 回適用</td><td style="color:rgb(0, 0, 0);text-align:left;">10 回適用</td><td style="color:rgb(0, 0, 0);text-align:left;">30 回適用</td><td style="color:rgb(0, 0, 0);text-align:left;">50 回適用</td></tr>
</tbody></table>
</li>

</ol>
<h3 style="text-align:left;background-color: rgb(221, 187, 187); border-width: 1px; border-style: solid; padding: 5px 3px 3px 0.5em; border-color: rgb(255, 204, 204) rgb(153, 102, 102) rgb(153, 102, 102) rgb(255, 204, 204); "><span style="display:inline;counter-increment:section 1;counter-reset:chapter 7">課題 ', counter(2.81133e+195), '-', counter(-2.46498e+75), ' </span></h3>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
これまでの課題で、2×2 行列 (第 1 回レポート課題) や 3×3 行列 (第 2 回レポート課題) を扱う関数を作ってきた。ここでは一般の行列およびベクトルを扱える関数を作成しよう。 </div>
<ol style="text-align:left;list-style-type:lower-alpha;">
<li style="text-align:left;line-height:130%;">
行列を保持する構造体 Matrix および、列ベクトルを保持する構造体 Vector を作成せよ。ただし、 <ul style="text-align:left;">
<li style="text-align:left;line-height:130%;">Matrix のメンバには、行の数 rows、列の数 cols、要素を保持するための double 型のポインタ elems を持たせること。</li>
<li style="text-align:left;line-height:130%;">Vector のメンバには、要素数 n、要素を保持するための double 型のポインタ elems を持たせること。</li>
</ul>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">これらの構造体を扱うために、以下の関数を作成せよ。</div>
<ul style="text-align:left;">
<li style="text-align:left;line-height:130%;">
Matrix のためのメモリを確保し各種メンバ変数を設定する関数 AllocateMatrix <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">int AllocateMatrix(Matrix *mat, int rows, int cols);
</pre>
rows, cols は行列の行の数、列の数を示す。返り値は、メモリの確保に成功すれば 1、失敗したら 0。この関数ではさらに、構造体のメンバ変数に、与えられた行の数、列の数を代入する。 </li><br style="text-align:left;"/>
<li style="text-align:left;line-height:130%;">
Matrix のためのメモリを解放する関数 ReleaseMatrix <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">void ReleaseMatrix(Matrix *mat);
</pre>
</li>
<li style="text-align:left;line-height:130%;">
Matrix をコピーする関数 CopyMatrix <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">void CopyMatrix(Matrix *inMat, Matrix *outMat);
</pre>
inMat がコピー元の行列、outMat がコピー先の行列。関数の内部で outMat のメモリの確保も行う。第 5 回の練習問題でやった「浅いコピー」にならないよう注意。 </li><br style="text-align:left;"/>
<li style="text-align:left;line-height:130%;">
行列の要素を表示する関数 FprintMatrix <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">void FprintMatrix(FILE *fp, Matrix *mat);
</pre>
fp は出力先のファイルポインタ (もし標準出力に表示したいなら引数として stdout を指定して呼び出す)。 </li><br style="text-align:left;"/>
<li style="text-align:left;line-height:130%;">
Vector のためのメモリを確保し各種メンバ変数を設定する関数 AllocateVector <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">int AllocateVector(Vector *vec, int n);
</pre>
n は列ベクトルの要素数を示す。返り値は、メモリの確保に成功すれば 1、失敗したら 0。この関数ではさらに、構造体のメンバ変数に、与えられた要素数を代入する。 </li><br style="text-align:left;"/>
<li style="text-align:left;line-height:130%;">
Vector のためのメモリを解放する関数 ReleaseVector <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">void ReleaseVector(Vector *vec);
</pre>
</li>
<li style="text-align:left;line-height:130%;">
Vector をコピーする関数 CopyVector <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">void CopyVector(Vector *inVec, Vector *outVec);
</pre>
inVec がコピー元の行列、outVec がコピー先の行列。関数の内部で outVec のメモリの確保も行う。第 5 回の練習問題でやった「浅いコピー」にならないよう注意。 </li><br style="text-align:left;"/>
<li style="text-align:left;line-height:130%;">
ベクトルの要素を表示する関数 FprintVector <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">void FprintVector(FILE *fp, Vector *vec);
</pre>
fp は出力先のファイルポインタ (もし標準出力に表示したいなら引数として stdout を指定して呼び出す)。 </li><br style="text-align:left;"/>
<li style="text-align:left;line-height:130%;">
Matrix と Vector の積を計算する MultMatrixVector 関数 <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">void MultMatrixVector(Matrix *A, Vector *V, Vector *Out);
</pre>
Out は計算結果となるベクトル。Out のメモリの確保は関数の内部では行わない。すでにメモリが確保されているものとする。 </li>
</ul><br style="text-align:left;"/>
これらの関数が正しく動作していることを確認できるプログラムを作成せよ。また、make コマンドを用いて分割コンパイルできるようにすること。 </li><br style="text-align:left;"/>
<li style="text-align:left;line-height:130%;">
上記で作成した関数を用いて、線形方程式を解くプログラムを作ってみよう。 <div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
まずは、線形方程式のデータをファイルから読み込む関数 LoadLinearSystem を作成しよう。 </div><pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">int LoadLinearSystem(const char *filename, Matrix *A, Vector *b)
</pre>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;"></div>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
ここで、filename は読み込むファイル名。この関数の中でファイルをオープンする。A および b は線形方程式 A x = b における係数行列 A と定数ベクトル b である。 関数の返り値は、読み込みに成功すれば 1 、失敗すれば 0 とする。 A および b のメモリの確保はこの関数の中で行われる。入力データは次のようなテキスト形式で与えられるものとする。 </div>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
</div><pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">(A の行数) (A の列数)
(A の 0 行目の要素がスペース区切りで並ぶ)
(A の 1 行目の要素がスペース区切りで並ぶ)
　：
(A の最後の行の要素がスペース区切りで並ぶ)
(b の要素がスペース区切りで並ぶ、b の要素数は A の行数と等しいとする)
</pre>
具体的には、次のテストデータを用いよ (リンク先からダウンロードできる)。 <ul style="text-align:left;">
<li style="text-align:left;line-height:130%;"><a href="http://archive.today/o/1052j/kanamori.cs.tsukuba.ac.jp/lecture/2018/prog2/pages/codes8/data2x2.txt" style="text-align:left;">2x2 係数行列のテストデータ</a></li>
<li style="text-align:left;line-height:130%;"><a href="http://archive.today/o/1052j/kanamori.cs.tsukuba.ac.jp/lecture/2018/prog2/pages/codes8/data3x3.txt" style="text-align:left;">3x3 係数行列のテストデータ</a></li>
<li style="text-align:left;line-height:130%;"><a href="http://archive.today/o/1052j/kanamori.cs.tsukuba.ac.jp/lecture/2018/prog2/pages/codes8/data4x4.txt" style="text-align:left;">4x4 係数行列のテストデータ</a></li>
<li style="text-align:left;line-height:130%;"><a href="http://archive.today/o/1052j/kanamori.cs.tsukuba.ac.jp/lecture/2018/prog2/pages/codes8/data10x10.txt" style="text-align:left;">10x10 係数行列のテストデータ</a></li>
</ul>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;"></div>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
次に、Gauss-Jordan 法を用いて線形方程式を解く関数 SolveGaussJordan を作成しよう。 </div><pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">int SolveGaussJordan(Matrix *A, Vector *b);
</pre>
ここで、A は線形方程式の係数行列、b は定数ベクトルである。A は正方行列であるものとする。 関数の内部で A および b の値は書き換えられ、最終的に b に線形方程式 A x = b の解ベクトル x が入る。 返り値は、解を求めることができれば 1 で、求められなければ 0 とする。 <div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;"></div>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
Gauss-Jordan 法を説明する。簡単のために、係数行列 A が 3x3 行列の場合で説明する。未知変数ベクトル x について x = (x<sub style="text-align:left;">0</sub>, x<sub style="text-align:left;">1</sub>, x<sub style="text-align:left;">2</sub>) であるとし、線形方程式 A x = b を書き下した結果が次のような連立方程式になるとする。
</div>
<pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">a<sub style="text-align:left;">00</sub> x<sub style="text-align:left;">0</sub> + a<sub style="text-align:left;">01</sub> x<sub style="text-align:left;">1</sub> + a<sub style="text-align:left;">02</sub> x<sub style="text-align:left;">2</sub> = b<sub style="text-align:left;">0</sub>
a<sub style="text-align:left;">10</sub> x<sub style="text-align:left;">0</sub> + a<sub style="text-align:left;">11</sub> x<sub style="text-align:left;">1</sub> + a<sub style="text-align:left;">12</sub> x<sub style="text-align:left;">2</sub> = b<sub style="text-align:left;">1</sub>
a<sub style="text-align:left;">20</sub> x<sub style="text-align:left;">0</sub> + a<sub style="text-align:left;">21</sub> x<sub style="text-align:left;">1</sub> + a<sub style="text-align:left;">22</sub> x<sub style="text-align:left;">2</sub> = b<sub style="text-align:left;">2</sub></pre>
Gauss-Jordan 法では、第 0 行から順に行ごとに計算を行う。まず第 0 行の対角成分 a<sub style="text-align:left;">00</sub>
で第 0 行を割り、対角成分の係数を 1 にする。 <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">　 x<sub style="text-align:left;">0</sub> + a'<sub style="text-align:left;">01</sub> x<sub style="text-align:left;">1</sub> + a'<sub style="text-align:left;">02</sub> x<sub style="text-align:left;">2</sub> = b'<sub style="text-align:left;">0</sub>
a<sub style="text-align:left;">10</sub> x<sub style="text-align:left;">0</sub> + a<sub style="text-align:left;">11</sub> x<sub style="text-align:left;">1</sub> + a<sub style="text-align:left;">12</sub> x<sub style="text-align:left;">2</sub> = b<sub style="text-align:left;">1</sub>
a<sub style="text-align:left;">20</sub> x<sub style="text-align:left;">0</sub> + a<sub style="text-align:left;">21</sub> x<sub style="text-align:left;">1</sub> + a<sub style="text-align:left;">22</sub> x<sub style="text-align:left;">2</sub> = b<sub style="text-align:left;">2</sub></pre>
次に、第 0 行にそれぞれ a<sub style="text-align:left;">10</sub>
および a<sub style="text-align:left;">20</sub>
を掛けて、第 1 行と第 2 行から引く。 そうすると、第 1 行と第 2 行の x<sub style="text-align:left;">0</sub>
の項がなくなる。 <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">　　x<sub style="text-align:left;">0</sub> + a'<sub style="text-align:left;">01</sub> x<sub style="text-align:left;">1</sub> + a'<sub style="text-align:left;">02</sub> x<sub style="text-align:left;">2</sub> = b'<sub style="text-align:left;">0</sub>
　　　　　a'<sub style="text-align:left;">11</sub> x<sub style="text-align:left;">1</sub> + a'<sub style="text-align:left;">12</sub> x<sub style="text-align:left;">2</sub> = b'<sub style="text-align:left;">1</sub>
　　　　　a'<sub style="text-align:left;">21</sub> x<sub style="text-align:left;">1</sub> + a'<sub style="text-align:left;">22</sub> x<sub style="text-align:left;">2</sub> = b'<sub style="text-align:left;">2</sub></pre>
今度は、第 1 行について計算を行う。第 1 行の対角成分 a'<sub style="text-align:left;">11</sub>
で第 1 行を割り、対角成分の係数を 1 にする。 <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">　　x<sub style="text-align:left;">0</sub> + a'<sub style="text-align:left;">01</sub> x<sub style="text-align:left;">1</sub> + a'<sub style="text-align:left;">02</sub> x<sub style="text-align:left;">2</sub> = b'<sub style="text-align:left;">0</sub>
　　　　　　　x<sub style="text-align:left;">1</sub> + a''<sub style="text-align:left;">12</sub> x<sub style="text-align:left;">2</sub> = b''<sub style="text-align:left;">1</sub>
　　　　　a'<sub style="text-align:left;">21</sub> x<sub style="text-align:left;">1</sub> + a'<sub style="text-align:left;">22</sub> x<sub style="text-align:left;">2</sub> = b'<sub style="text-align:left;">2</sub></pre>
次に、第 1 行にそれぞれ a'<sub style="text-align:left;">01</sub>
および a'<sub style="text-align:left;">21</sub>
を掛けて、第 0 行と第 2 行から引く。 すると、第 0 行と第 2 行の x<sub style="text-align:left;">1</sub>
の項が消える。 <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">　　x<sub style="text-align:left;">0</sub> 　　　　　+ a''<sub style="text-align:left;">02</sub> x<sub style="text-align:left;">2</sub> = b''<sub style="text-align:left;">0</sub>
　　　　　　　x<sub style="text-align:left;">1</sub> + a''<sub style="text-align:left;">12</sub> x<sub style="text-align:left;">2</sub> = b''<sub style="text-align:left;">1</sub>
　　　　　　　　　 a''<sub style="text-align:left;">22</sub> x<sub style="text-align:left;">2</sub> = b''<sub style="text-align:left;">2</sub></pre>
これを第 2 行についても同様に行うと、最終的に次のような式になる。 <pre style="text-align:left;background-color: rgb(238, 238, 240); margin-left:40px;overflow-x:auto;overflow-y:auto;width:90%;border-width: 1px; border-style: solid; padding: 5px; border-color: gray; ">　　x<sub style="text-align:left;">0</sub> 　　　　　　　　　　= b'''<sub style="text-align:left;">0</sub>
　　　　　　　x<sub style="text-align:left;">1</sub> 　　　　　= b'''<sub style="text-align:left;">1</sub>
　　　　　　　　　　　　x<sub style="text-align:left;">2</sub> = b'''<sub style="text-align:left;">2</sub></pre>
右辺の値がこの連立方程式の解である。 <div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
なお上記の手順では、対角成分がゼロになると計算ができない。「ピボット選択」という操作を行えば回避できるが、今回の課題ではそれは扱わず、SolveGaussJordan 関数でエラーメッセージを表示し、返り値として 0 を返して終了するようにせよ。</div>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
計算結果が、線形方程式 A x = b を満たしているか確認しよう。Gauss-Jordan 法によって得られた解ベクトルが x だとして、係数行列 A との積 A x を b' とおく。 ||b' - b||<sup style="text-align:left;">2</sup>
が誤差であるとして、その結果を出力せよ。make コマンドを用いて分割コンパイルできるようにすること。 </div>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
<b style="text-align:left;"><font color="red" style="text-align:left;">
※問題 a と同じソースファイル/ヘッダファイルを用いる場合は、レポートの問題 a の解答にそれらを載せておけば問題 b の解答には載せなくてよい。 </font></b>
</div><div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;"><strong style="text-align:left;">[実行例]</strong></div>
<pre style="text-align:left;background-color: rgb(240, 248, 255); font-family:Fixed, monospace;margin-left:40px;padding-left:5px;border-width: 1px; border-style: solid; border-color: gray; ">$ ./solver data4x4.txt
LoadLinearSystem: matrix size: 4x4

Matrix A(4,4):
-7.000000 1.000000 -10.000000 -6.000000
7.000000 5.000000 -9.000000 2.000000
8.000000 5.000000 5.000000 3.000000
-9.000000 8.000000 -7.000000 1.000000

Vector b(4):
2.000000 9.000000 8.000000 8.000000

Answer: x(4)
(※ここに計算結果が表示される)

error = 0.000000

$ ./solver data10x10.txt
LoadLinearSystem: matrix size: 10x10

Matrix A(10,10):
-2.000000 2.000000 -7.000000 -7.000000 -7.000000 -1.000000 9.000000 9.000000 -5.000000 -9.000000
-3.000000 -6.000000 6.000000 6.000000 2.000000 -4.000000 6.000000 -8.000000 6.000000 4.000000
2.000000 9.000000 -8.000000 5.000000 3.000000 7.000000 -3.000000 1.000000 -2.000000 4.000000
-9.000000 2.000000 2.000000 -2.000000 7.000000 -10.000000 1.000000 -1.000000 7.000000 4.000000
1.000000 -4.000000 9.000000 2.000000 9.000000 -10.000000 7.000000 3.000000 -5.000000 4.000000
-8.000000 -5.000000 -3.000000 4.000000 3.000000 5.000000 0.000000 6.000000 7.000000 7.000000
6.000000 9.000000 2.000000 -2.000000 1.000000 9.000000 1.000000 6.000000 -9.000000 -5.000000
2.000000 6.000000 8.000000 6.000000 1.000000 7.000000 6.000000 9.000000 -3.000000 1.000000
-8.000000 2.000000 1.000000 -8.000000 -3.000000 -8.000000 -6.000000 4.000000 9.000000 -3.000000
-6.000000 5.000000 -8.000000 -4.000000 7.000000 -3.000000 5.000000 9.000000 5.000000 1.000000

Vector b(10):
9.000000 -4.000000 -9.000000 9.000000 2.000000 -10.000000 -2.000000 -4.000000 -2.000000 -7.000000

Answer: x(10)
(※ここに計算結果が表示される)

error = 0.000000
</pre>
</li>
</ol>
<a name="QandA" style="text-align:left;"></a>
<h3 style="text-align:left;background-color: rgb(221, 187, 187); border-width: 1px; border-style: solid; padding: 5px 3px 3px 0.5em; border-color: rgb(255, 204, 204) rgb(153, 102, 102) rgb(153, 102, 102) rgb(255, 204, 204); ">Q &#38; A</h3>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
レポートに関して類似した質問が多くあった場合、以下にその質問と回答を掲載します。定期的にチェックしてください。 </div>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
<strong style="text-align:left;">Q. 「浅いコピー」ではなく「深いコピー」をやるにはどうしたらいいですか？　練習問題 7-3 のように strcpy 関数を使えばよいですか？</strong><br style="text-align:left;"/>
A. 文字列なら strcpy 関数でコピーができますが、今回の問題の場合は文字列ではないので、データの末尾にヌル文字がなく、使えません。動的に確保した配列に for 文で要素をひとつずつコピーするか、string.h ヘッダに定義されている memcpy 関数を使ってください。memcpy 関数についてはネットなどで調べてみてください。 </div>
<div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;">
<strong style="text-align:left;">Q. AllocateImage 関数の中で</strong>
</div><div style="text-align:left;"><div style="text-align:left;width:100%;position:relative;overflow-x:auto;overflow-y:auto;font-size:1em;background-color: white; margin: 1em 0px; "><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;bottom:auto;float:none;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;text-align:left;vertical-align:baseline;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;position:absolute;right:1px;top:1px;width:11px;height:11px;font-size:10px;z-index:10;color:white;background-color:rgb(108, 226, 108);outline:invert none 0px;border-width:medium;border-style:none;margin:0px;padding:0px;border-color:white"><span><a href="http://archive.today/o/1052j/kanamori.cs.tsukuba.ac.jp/lecture/2018/prog2/pages/r7.html%23" style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;display:block;text-align:center;text-decoration:none;color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:1px 0px 0px;border-color:white">?</a></span></div><table style="border-collapse:separate;border-spacing:0px;border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;width:100%;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white"><tbody style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white"><tr style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white"><td style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:rgb(175, 175, 175);outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white"><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;text-align:right;outline:invert none 0px;border-width:0px 3px 0px 0px;border-style:none solid none none;margin:0px;padding:0px 0.5em 0px 1em;border-color:white rgb(108, 226, 108) white white">1</div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;text-align:right;outline:invert none 0px;border-width:0px 3px 0px 0px;border-style:none solid none none;margin:0px;padding:0px 0.5em 0px 1em;border-color:white rgb(108, 226, 108) white white">2</div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;text-align:right;outline:invert none 0px;border-width:0px 3px 0px 0px;border-style:none solid none none;margin:0px;padding:0px 0.5em 0px 1em;border-color:white rgb(108, 226, 108) white white">3</div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;text-align:right;outline:invert none 0px;border-width:0px 3px 0px 0px;border-style:none solid none none;margin:0px;padding:0px 0.5em 0px 1em;border-color:white rgb(108, 226, 108) white white">4</div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;text-align:right;outline:invert none 0px;border-width:0px 3px 0px 0px;border-style:none solid none none;margin:0px;padding:0px 0.5em 0px 1em;border-color:white rgb(108, 226, 108) white white">5</div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;text-align:right;outline:invert none 0px;border-width:0px 3px 0px 0px;border-style:none solid none none;margin:0px;padding:0px 0.5em 0px 1em;border-color:white rgb(108, 226, 108) white white">6</div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;text-align:right;outline:invert none 0px;border-width:0px 3px 0px 0px;border-style:none solid none none;margin:0px;padding:0px 0.5em 0px 1em;border-color:white rgb(108, 226, 108) white white">7</div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;text-align:right;outline:invert none 0px;border-width:0px 3px 0px 0px;border-style:none solid none none;margin:0px;padding:0px 0.5em 0px 1em;border-color:white rgb(108, 226, 108) white white">8</div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;text-align:right;outline:invert none 0px;border-width:0px 3px 0px 0px;border-style:none solid none none;margin:0px;padding:0px 0.5em 0px 1em;border-color:white rgb(108, 226, 108) white white">9</div></td><td style="color:rgb(0, 0, 0);border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;width:100%;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white"><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;position:relative;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white"><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px 1em;border-color:white"><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-style:normal;font-size:1em;font-weight:bold;color:gray;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">int</code> <code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:black;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">AllocateImage(ImageData *img, </code><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-style:normal;font-size:1em;font-weight:bold;color:gray;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">int</code> <code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:black;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">_w, </code><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-style:normal;font-size:1em;font-weight:bold;color:gray;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">int</code> <code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:black;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">_h, </code><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-style:normal;font-size:1em;font-weight:bold;color:gray;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">int</code> <code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:black;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">_channels) {</code></div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px 1em;border-color:white"><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">  </code><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:black;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">...</code></div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px 1em;border-color:white"> </div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px 1em;border-color:white"><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">  </code><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:black;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">img = (ImageData *)</code><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-style:normal;font-size:1em;font-weight:bold;color:rgb(255, 20, 147);outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">malloc</code><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:black;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">(...); </code></div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px 1em;border-color:white"> </div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px 1em;border-color:white"><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">  </code><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:rgb(0, 130, 0);outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">/* img のメンバ変数に値を代入 */</code></div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px 1em;border-color:white"> </div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px 1em;border-color:white"><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">  </code><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:black;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">...</code></div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px 1em;border-color:white"><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:black;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">}</code></div></div></td></tr></tbody></table></div></div>
<strong style="text-align:left;">という風に書いて、main 関数の中で</strong>
<div style="text-align:left;"><div style="text-align:left;width:100%;position:relative;overflow-x:auto;overflow-y:auto;font-size:1em;background-color: white; margin: 1em 0px; "><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;bottom:auto;float:none;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;text-align:left;vertical-align:baseline;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;position:absolute;right:1px;top:1px;width:11px;height:11px;font-size:10px;z-index:10;color:white;background-color:rgb(108, 226, 108);outline:invert none 0px;border-width:medium;border-style:none;margin:0px;padding:0px;border-color:white"><span><a href="http://archive.today/o/1052j/kanamori.cs.tsukuba.ac.jp/lecture/2018/prog2/pages/r7.html%23" style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;display:block;text-align:center;text-decoration:none;color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:1px 0px 0px;border-color:white">?</a></span></div><table style="border-collapse:separate;border-spacing:0px;border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;width:100%;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white"><tbody style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white"><tr style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white"><td style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:rgb(175, 175, 175);outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white"><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;text-align:right;outline:invert none 0px;border-width:0px 3px 0px 0px;border-style:none solid none none;margin:0px;padding:0px 0.5em 0px 1em;border-color:white rgb(108, 226, 108) white white">1</div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;text-align:right;outline:invert none 0px;border-width:0px 3px 0px 0px;border-style:none solid none none;margin:0px;padding:0px 0.5em 0px 1em;border-color:white rgb(108, 226, 108) white white">2</div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;text-align:right;outline:invert none 0px;border-width:0px 3px 0px 0px;border-style:none solid none none;margin:0px;padding:0px 0.5em 0px 1em;border-color:white rgb(108, 226, 108) white white">3</div></td><td style="color:rgb(0, 0, 0);border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;width:100%;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white"><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;position:relative;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white"><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px 1em;border-color:white"><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:black;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">ImageData anImg;</code></div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px 1em;border-color:white"> </div><div style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;white-space:pre;background-color:white;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px 1em;border-color:white"><code style="border-top-left-radius:0px 0px;border-top-right-radius:0px 0px;border-bottom-right-radius:0px 0px;border-bottom-left-radius:0px 0px;background-image:none;background-color:transparent;bottom:auto;float:none;height:auto;left:auto;line-height:1.1em;overflow-x:visible;overflow-y:visible;position:static;right:auto;text-align:left;top:auto;vertical-align:baseline;width:auto;box-sizing:content-box;-moz-box-sizing:content-box;-ms-box-sizing:content-box;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:1em;color:black;outline:invert none 0px;border-width:0px;border-style:none;margin:0px;padding:0px;border-color:white">AllocateImage(&#38;anImg, ... );</code></div></div></td></tr></tbody></table></div></div>
<strong style="text-align:left;">という風に呼び出したのですが、main 関数の anImg のメンバ変数に値が代入されていません。なぜですか？</strong><br style="text-align:left;"/>
A. AllocateImage 関数の引数 img には、最初 main 関数内の変数 anImg のアドレスが入っています。しかし、ポインタ img の持つアドレスを malloc 関数で確保した新しいメモリのアドレスで上書きしており、anImg とは別の場所を指すようになってしまっています。これでは、AllocateImage 関数の中で img のメンバ変数に何を代入しようとも、main 関数の変数 anImg には何の影響もありません。そもそもこのように書いた場合、AllocateImage 関数に渡された img が持つアドレスには、すでにメモリが確保されている (main 関数の anImg) ので、img に対して malloc 関数でメモリを割り当てる必要はありません。では何に対して malloc 関数を使ってメモリを確保するかは、練習問題 7-3 を復習してください。 <div style="margin-top:16px;margin-bottom:16px;text-align:left;line-height:140%;"></div>

<br style="text-align:left;"/><br style="text-align:left;"/>
</div></div></div></body></html>